name: my CI test
on: push
jobs:
  job_build:
    runs-on: ubuntu-latest
    steps:
    - name: install Java
      uses: actions/setup-java@v1
      with:
        java-version: 1.8
    - name: check
      run: |
        - java -version
        - javac -version
        - mvn -v
    - name: build
      run: |
        - mvn compile
  job_test:
    runs-on: ubuntu-latest
    steps:
    - name: test
      run: |
        - mvn clean test
        - awk -F"," '{ instructions += $4 + $5; covered += $5 } END { print covered, "/", instructions, "instructions covered"; print 100*covered/instructions, "% covered" }' target/site/jacoco/jacoco.csv
    needs: job_build